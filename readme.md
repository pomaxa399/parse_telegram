# Установка парсера открытых ТГ каналов:
1. Клонировать Git репозиторий себе на компьютер
2. Из папки myenv скопировать 2 файла в корневую папку
3. Создать виртуальное оркужения для проекта
4. Выполнить команду pip install -r requirements, чтобы установить необходимые зависимости
5. После установки всех библиотек нужно заменить 2 файла в библиотеке snscrape, которая будет в папке виртуального окружения. Файл base.py в корневую папку snscrape, а файл telegram.py в подпапку snscrape/modules/

На этом установка закончена.

## Работа парсера:
На данный момент парсер имеет файлы step_1,2,3. Соответственно запускать их и нужно по очереди.
### step_1.py:
На данный момент собирает каналы из гугл таблицы и сохраняет ее в переменную. Этот шаг можно убрать и загружать списком каналы из текстового файла.
### step_2.py:
Импортирует переменную с каналами из step_1.py и потом начинает собирать уже посты по заданным параметрам.
- **max_res** = True/False - включает/выключает на ограничение кол-ва постов с канала.
- **num_res** = 100 - задается кол-во постов, работает только с max_res=True.
- **start_date** = '2023-01-01'- можно задать дату от которой необходимо отсортировать посты.
Если max_res=False, то парсер собирает все посты от создания канала и до последнего возможного на данный момент.

#### На выходе из step_2.py будет 3 папки с данными:
- ***result*** - техническая папка содержит сырые данные парсинга, чтоб по 100 раз не парсить одно и то же
- ***encoded*** - содержит уже очищенные данные, будут удалены все пустые файлы, которые возникают при парсинге неверных url адресов, либо закрытых каналов + исправляет кодировки, удаляет смайлы и прочее.
- ***filtered_result*** - содержит уже очищенные данные, но еще дополнительно отсортированные по заданной дате.
### step_3.py:
Проходит по заданной папке и собирает все данные для занесения в csv файл. Настраивается:
- ***file_path*** = *'encoded' / 'filtered_result'* - название папки для формирования csv файла по очищенным данным или по отсортированным по дате.
#### На выходе получаете data.csv со столбцами:
- ***Title*** - название канала
- ***Chat_id_or_url*** - чат id для закрытых каналов, либо url адрес поста для открытых каналов. *Сделано так, чтобы можно было потом объеденить csv файлы для закрытых и открытых ТГ каналов в один датасет*.
- ***Post_id*** - столбец для закрытых ТГ каналов, т.к. работая по API нельзя получить ссылку на пост. В data.csv открытых каналов будет пустой столбец.
- ***Date*** - дата публикации поста.
- ***Content*** - текстовые данные постов.
- ***Image_url*** - ссылки на картинки с поста, превью сайта.
- ***Video_preview*** - ссылки на картинки превью видео в постах.
- ***Views*** - кол-во просмотров поста.